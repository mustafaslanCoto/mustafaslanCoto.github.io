<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <title>MUSTAFA ASLAN – slides</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="style.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<meta property="og:title" content="MUSTAFA ASLAN">
<meta property="og:site_name" content="MUSTAFA ASLAN">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2">

<!-- logo style -->
<style>
  .logo-left {
    position: absolute;
    top: 10px;
    left: 20px;
  }

  .logo-right {
    position: absolute;
    top: 10px;
    right: 20px;
    display: flex;
    gap: 10px;
    align-items: flex-start;
  }

  .logo-left img,
  .logo-right img {
    height: 160px;
    width: auto;
    
  }
  
/* title sytle */
  h1 {
    text-align: center;
  }

</style>
<div class="logo-left">
<p><img src="images/cu.png" alt="Left Logo"> <img src="images/wgsss.png" alt="Left Logo 2"> <img src="images/hcrw_back.png" alt="Left Logo 3"></p>
</div>
<div class="logo-right">
<p><img src="images/dlsg.png" alt="Right Logo"> <img src="images/care.png" alt="Right Logo 2"></p>
</div>
<br> <br> <br> <br> <br> <br> <br>
<h1>
Forecasting Mental Health Hospital Bed Occupancy: A Regime-Switching AutoRegressive Hidden Markov Model Approach
</h1>
<div class="title-block">
<br> <br> <br> <br> <br> <br>
<h3>
Mustafa Aslan, Cardiff University, UK <br> Lead supervisor: Prof.&nbsp;Bahman Rostami-Tabar<br> Co-supervisor: Dr.&nbsp;Jeremy Dixon <br> Data Lab for Social Good <br> Cardiff University, UK <br> <!-- <span style="color: rgba(179, 0, 0, 0.7); font-weight: bold;">Slides:</span>
  <a href="https://mustafaslancoto.github.io/talks/" style="color: #000; font-weight: bold; text-decoration: underline dotted;text-underline-offset: 5px">
    https://mustafaslancoto.github.io/talks/
  </a> -->
</h3>
<p>
16 Sep 2025
</p>
</div>
</section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<ul>
<li><p>The problem</p></li>
<li><p>Data and preliminary analysis</p></li>
<li><p>Experiment design and Modelling framework</p></li>
<li><p>Results</p></li>
<li><p>Key findings</p></li>
<li><p>Next steps</p></li>
</ul>
</section>
<section>
<section id="the-problem" class="title-slide slide level1 center">
<h1>The Problem</h1>

</section>
<section id="current-systemic-issues-in-patient-flow" class="slide level2">
<h2>Current Systemic Issues in Patient Flow</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p><img data-src="images/late_shift.png" style="width:100.0%"></p>
</div><div class="column fragment" style="width:50%;">
<ul>
<li>Unpredictable occupancy levels can result in redundant staffing and resource allocation, driving up costs, or in understaffing, which compromises patient care.</li>
</ul>
<p><br></p>
<ul>
<li>Spikes in occupancy level drive overtime, sickness, and <strong>staff burnout</strong>.</li>
</ul>
<p><br></p>
<ul>
<li>Lack of analytical solutions that can capture the complexity and uncertainty of patient flow and bed availability limits proactive decision-making.</li>
</ul>
</div></div>
</section>
<section id="why-is-it-important" class="slide level2">
<h2>Why is it important?</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<h3 id="why-is-an-efficient-bed-management-system-crucial">Why is an efficient bed management system crucial?</h3>
<ul>
<li>Hospital beds are one of most costly healthcare resources.
<ul>
<li>NHS rates for acute mental health beds are generally between £760 and £850 per day in 2025</li>
</ul></li>
<li>Bed shortages force some patients to wait in corridors, impacting care quality and safety.</li>
<li>Bed shortages increase staff pressure, burnout, and operational costs.</li>
</ul>
<p><img data-src="images/bed_shortages.jpg" style="width:100.0%"></p>
</div><div class="column fragment" style="width:50%;">
<h3 id="why-a-reliable-forecasting-approach-is-needed">Why a reliable forecasting approach is needed?</h3>
<ul>
<li>Mental health demand is volatile and influenced by unpredictable crisis, by seasonality, epidemics, and unforeseen events.</li>
<li>A reliable forecasting approach enables timely staffing, resource allocation, and improved patient care.</li>
<li>Anticipating demand allows decision-makers to balance scarce resources while improving patient flow and safety.</li>
<li>Robust forecasts enhance resilience to unexpected surges and reduce staff burnout.</li>
</ul>
</div></div>
</section>
<section id="what-do-we-forecast" class="slide level2">
<h2>What do we forecast?</h2>
<ul>
<li>Daily hospital bed occupancy for 7 wards in a UK hospital.</li>
<li><strong>Forecast horizon:</strong> 30 days ahead, supporting medium-term planning for bed allocation and staffing, generated at the end of each month for the following month.</li>
<li>Focus on <strong>probabilistic forecasting</strong> to capture uncertainty, offering prediction intervals rather than single-point estimates using a reliable model.</li>
</ul>
<div id="b949165b" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="1">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-2-output-1.png" class="quarto-figure quarto-figure-center" width="1716" height="760"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-research-questions" class="slide level2">
<h2>Key Research Questions</h2>
<ul>
<li><p>How can we accurately forecast hospital bed occupancy to improve resource allocation and patient care?</p></li>
<li><p>How can probabilistic forecasting models be developed to account for the inherent uncertainty in patient flow and bed availability?</p></li>
<li><p>What are the hidden factors influencing bed occupancy, and how can they be incorporated into forecasting models?</p></li>
</ul>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="data-and-preliminary-analysis" class="title-slide slide level1 center">
<h1>Data and preliminary analysis</h1>

</section>
<section id="dataset" class="slide level2">
<h2>Dataset</h2>
<p>Daily hospital occupancy data from a UK hospital with 7 wards, spanning from July 2018 to April 2025. The dataset includes:</p>
<ul>
<li>Daily occupancy counts for each ward (daily number of patients staying in each ward)</li>
<li>Date-related features: day of the week, month, year, day of the month, week of the year</li>
<li>Holiday indicators</li>
</ul>
</section>
<section id="data-characteristics" class="slide level2">
<h2>Data characteristics</h2>
<ul>
<li><p>Strong upward trend in occupancy over time</p></li>
<li><p>Spike after COVID-19 pandemic</p></li>
</ul>
<div id="b1bf0826" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-4-output-1.png" class="quarto-figure quarto-figure-center" width="2035" height="980"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="seasonal-patterns" class="slide level2">
<h2>Seasonal patterns</h2>
<h3 id="day-of-the-week-seasonality">Day of the week seasonality</h3>
<div id="8fb5f601" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-5-output-1.png" class="quarto-figure quarto-figure-center" width="2077" height="1024"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="seasonal-patterns-1" class="slide level2">
<h2>Seasonal patterns</h2>
<h3 id="monthly-seasonality">Monthly seasonality</h3>
<div id="9f137acf" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-6-output-1.png" class="quarto-figure quarto-figure-center" width="2079" height="1022"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="effect-of-holidays" class="slide level2">
<h2>Effect of holidays</h2>
<div id="f95a1e26" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="6">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-7-output-1.png" class="quarto-figure quarto-figure-center" width="1875" height="923"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-insights-from-data-analysis" class="slide level2">
<h2>Key insights from data analysis</h2>
<h3 id="an-important-assumption-to-model-stationarity">An important assumption to model: Stationarity</h3>
<p>One approach to make the series stationary is to take the first <code>difference</code> of the series.</p>
<p>Original series: <span class="math inline">\(y_t, y_{t-1}, y_{t-2}, y_{t-3}, \ldots\)</span><br>
Differenced series: <span class="math inline">\(y_t - y_{t-1}, y_{t-1} - y_{t-2}, y_{t-2} - y_{t-3}, \ldots\)</span></p>
<div id="a88d5745" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-8-output-1.png" class="quarto-figure quarto-figure-center" width="1674" height="832"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-insights-from-data-analysis-1" class="slide level2">
<h2>Key insights from data analysis</h2>
<h3 id="information-from-acf-and-pacf-plots-after-differencing">Information from ACF and PACF plots after differencing</h3>
<div id="86fc56e0" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="8">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-9-output-1.png" class="quarto-figure quarto-figure-center" width="2035" height="980"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-insights-from-data-analysis-2" class="slide level2">
<h2>Key insights from data analysis</h2>
<h3 id="alternative-approach-to-make-the-series-stationary-and-keep-the-dependence-structure">Alternative approach to make the series stationary and keep the dependence structure</h3>
<div id="0a131dff" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="9">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-10-output-1.png" class="quarto-figure quarto-figure-center" width="1705" height="897"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="an-important-assumption-to-model-stationarity-1" class="slide level2">
<h2>An important assumption to model: Stationarity</h2>
<h3 id="information-from-acf-and-pacf-plots-after-detrending">Information from ACF and PACF plots after detrending</h3>
<div id="82369bc1" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="10">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-11-output-1.png" class="quarto-figure quarto-figure-center" width="2035" height="980"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regime-switching-autoregressive-hidden-markov-model-rs-arhmm" class="slide level2 smaller">
<h2>Regime-Switching AutoRegressive Hidden Markov Model (RS-ARHMM)</h2>
<p>Let <span class="math inline">\(y_t\)</span> be the observed value at time <span class="math inline">\(t\)</span>, modeled as a function of its <span class="math inline">\(p\)</span> lagged values, the regime-specific parameters associated with the hidden state <span class="math inline">\(s_t\)</span>, and exogenous variables <span class="math inline">\(\mathbf{X}_t = (X_{t1}, \ldots, X_{tM})\)</span>.</p>
<p>The <strong>RS-ARHMM</strong> can be expressed as follows:</p>
<p><span class="math display">\[
y_t^{(s)} = \beta_{0}^{(s)} + \sum_{i=1}^{p} \beta_{i}^{(s)} \, y_{t-i} + \sum_{j=1}^{M} \beta_{p+j}^{(s)} \, X_{tj} + \epsilon_t^{(s)},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\beta_{i}^{(s)}\)</span> are the coefficients for the lagged values for regime <span class="math inline">\(s\)</span>,</li>
<li><span class="math inline">\(\beta_{p+j}^{(s)}\)</span> are the coefficients for the exogenous variables for regime <span class="math inline">\(s\)</span>,</li>
<li><span class="math inline">\(M\)</span> is the number of exogenous variables,</li>
<li><span class="math inline">\(\epsilon_t^{(s)}\)</span> is the error term for regime <span class="math inline">\(s\)</span>.</li>
</ul>
<p>The <strong>Markov property</strong>: <span class="math display">\[
P(s_t = k \mid s_{1:t-1}) = P(s_t = k \mid s_{t-1}), \quad \forall t \geq 2.
\]</span></p>
<p>A HMM has the following components:</p>
<ul>
<li><span class="math inline">\(S\)</span>: The set of regimes, <span class="math inline">\(\mathbb{S} = \{S_1, S_2, \ldots, S_K\}\)</span>.</li>
<li><span class="math inline">\(P\)</span>: The transition probability matrix</li>
<li><span class="math inline">\(p_{ij} = P(s_t = S_j \mid s_{t-1} = S_i)\)</span> is the probability of transitioning from regime <span class="math inline">\(S_i\)</span> to regime <span class="math inline">\(S_j\)</span>, s.t. <span class="math inline">\(\sum_{j=1}^{K} p_{ij} = 1\)</span>.</li>
</ul>
<p><strong>Transition matrix <span class="math inline">\(P\)</span></strong> is defined as:</p>
<p><span class="math display">\[
P = \begin{pmatrix}
p_{11} &amp; \cdots &amp; p_{1K} \\
\vdots &amp; \ddots &amp; \vdots \\
p_{K1} &amp; \cdots &amp; p_{KK}
\end{pmatrix}
\]</span></p>
</section>
<section id="modeling-framework" class="slide level2">
<h2>Modeling Framework</h2>
<h3 id="forecasting-with-rs-arhmm">Forecasting with RS-ARHMM</h3>
<ul>
<li><strong>Forecast Computation</strong>: The final forecast for each time step is a weighted average of the forecasts from each regime, <code>weighted by the predicted regime probabilities</code>:</li>
</ul>
<p><span class="math display">\[
\hat{y}_{T+h} = \sum_{j=1}^{K} P(s_{T+h} = S_j) \, \hat{y}_{T+h}^{(S_j)}
\]</span></p>
<ul>
<li><strong>State Prediction</strong>: We predict the most probable state sequence for the next <span class="math inline">\(h\)</span> time steps using the transition matrix <span class="math inline">\(\mathbf{P}\)</span>. The probability of being in state <span class="math inline">\(S_j\)</span> at time <span class="math inline">\(T+h\)</span> is computed recursively as:</li>
</ul>
<p><span class="math display">\[
P(s_{T+h} = S_j) = \sum_{i=1}^{K} P(s_{T+h-1} = S_i) \, p_{ij}
\]</span></p>
<ul>
<li><strong>Regime-specific forecasts</strong>: For each predicted regime, we utilize the corresponding regression model to forecast the observation at that time step. The predicted observation <span class="math inline">\(\hat{y}_{T+h}\)</span> for state <span class="math inline">\(s_{T+h}\)</span> is computed as:</li>
</ul>
<p><span class="math display">\[
\hat{y}_{T+h}^{s_{T+h}} = \beta_{0}^{(s_{T+h})} + \sum_{i=1}^{p} \beta_{i}^{(s_{T+h})} \, y_{T+h-i} + \sum_{j=1}^{M} \beta_{p+j}^{(s_{T+h})} \, X_{T+h,j}
\]</span></p>
</section>
<section id="rs-arhmm-parameter-estimation" class="slide level2">
<h2>RS-ARHMM Parameter Estimation</h2>
<div class="columns">
<div class="column fragment" style="width:30%;">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><code>EM (Expectation-Maximization) Algorithm</code></strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>Iteratively estimates parameters <span class="math inline">\(\Theta = \{\beta^{(s)}, \sigma^{2(s)}, P, \pi\}\)</span> to maximize likelihood.</p></li>
<li><p>Alternates between two steps:</p>
<ul>
<li><strong>E-Step:</strong> Estimate regime probabilities given current <span class="math inline">\(\Theta\)</span>.</li>
<li><strong>M-Step:</strong> Update <span class="math inline">\(\Theta\)</span> using these probabilities.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div><div class="column fragment" style="width:35%;">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>1. E-Step</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p><strong>State probability:</strong><br>
<span class="math display">\[
\gamma_t(i) = P(s_t = S_i \mid y_{1:T}, \Theta^{(k)})
\]</span></p></li>
<li><p><strong>Transition probability:</strong><br>
<span class="math display">\[
\xi_t(i,j) = P(s_t = S_i, s_{t+1} = S_j \mid y_{1:T}, \Theta^{(k)})
\]</span></p></li>
<li><p>Computed via <strong>Forward-Backward algorithm</strong>:</p>
<ul>
<li>Forward:</li>
</ul>
<p><span class="math inline">\(\alpha_t(i) = P(y_{1:t}, s_t = S_i \mid \Theta) = \sum_{j=1}^{K} \alpha_{t-1}(j) p_{ji} o_i(y_t)\)</span></p>
<ul>
<li>Backward:</li>
</ul>
<p><span class="math inline">\(b_t(i) = P(y_{t+1:T} \mid s_t = S_i, \Theta) = \sum_{j=1}^{K} p_{ij} o_j(y_{t+1}) b_{t+1}(j)\)</span></p></li>
</ul>
<p><strong>Emission (observation) likelihood:</strong><br>
<span class="math display">\[
o_i(y_t) = \frac{1}{\sqrt{2\pi \sigma_i^2}} \exp\left( -\frac{(y_t - \mu_{i,t})^2}{2\sigma_i^2} \right)
\]</span></p>
<p>where <span class="math inline">\(\mu_{i,t}\)</span> is AR + exogenous mean for state <span class="math inline">\(i\)</span>.</p>
</div>
</div>
</div>
</div><div class="column fragment" style="width:35%;">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>2. M-Step</strong></p>
</div>
<div class="callout-content">
<p>Update parameters using weighted averages with <span class="math inline">\(\gamma_t(i)\)</span>:</p>
<ul>
<li><p><strong>Transition matrix:</strong><br>
<span class="math display">\[
p_{ij}^{(k+1)} = \frac{\sum_{t=1}^{T-1} \xi_t(i,j)}{\sum_{t=1}^{T-1} \gamma_t(i)}
\]</span></p></li>
<li><p><strong>Initial state:</strong><br>
<span class="math display">\[
\pi_i^{(k+1)} = \gamma_1(i)
\]</span></p></li>
<li><p><strong>Regression (AR/exog) coefficients:</strong><br>
<span class="math display">\[
\beta^{(i,k+1)} = (\mathbf{X}^T \mathbf{W}_i \mathbf{X})^{-1} \mathbf{X}^T \mathbf{W}_i \mathbf{y}
\]</span></p></li>
</ul>
<p>Where <span class="math inline">\(\mathbf{W}_i = \text{diag}(\gamma_1(i),\dots,\gamma_T(i))\)</span></p>
<ul>
<li><strong>Variance:</strong><br>
<span class="math display">\[
\sigma_i^{2(k+1)} = \frac{\sum_{t=1}^T \gamma_t(i)(y_t-\mu_{i,t})^2}{\sum_{t=1}^T \gamma_t(i)}
\]</span></li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Repeat E-M Steps until convergence:</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[|\ell(\Theta^{(k+1)}) - \ell(\Theta^{(k)})| &lt; \epsilon\]</span></p>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="why-rs-arhmm" class="slide level2">
<h2>Why RS-ARHMM?</h2>
<ul>
<li class="fragment"><p><strong>Captures regime changes</strong> in highly volatile time series data (e.g., healthcare), integrating them into the forecasting process, making it more accurate and reliable predictions.</p></li>
<li class="fragment"><p><strong>Traditional statistical and modern machine learning models</strong> fail to account for such regime shifts.</p></li>
<li class="fragment"><p><strong>Models complex dependencies and non-linear relationships</strong> with reduced risk of overfitting and less reliance on extensive hyperparameter tuning.</p></li>
<li class="fragment"><p><strong>Produces interpretable results</strong> through regime-specific parameters.</p></li>
<li class="fragment"><p><strong>Provides reliable forecasts</strong> that incorporate uncertainty arising from regime changes.</p></li>
</ul>
</section>
<section id="benchmark-models" class="slide level2">
<h2>Benchmark models</h2>
<p><strong>Statistical models:</strong></p>
<ul>
<li><code>Exponential Smoothing (ETS)</code>: A state space time series model capturing level, trend, and seasonality.</li>
<li><code>Linear Regression</code>: A statistical model that estimates the linear relationship between predictors and a response variable.</li>
<li><code>Lasso Regression</code>: A regression method with <em>L1</em> regularization, useful for variable selection and preventing overfitting.</li>
</ul>
<p><strong>Machine Learning models:</strong></p>
<ul>
<li><code>XGBoost</code>: An optimized gradient boosting library designed to be highly efficient and flexible. It uses level-wise tree growth, building trees level by level horizontally.</li>
<li><code>LightGBM</code>: A gradient boosting framework that uses tree-based learning algorithms, known for its speed and efficiency. It uses leaf-wise tree growth.</li>
<li><code>Random Forest</code>: An ensemble learning method that builds multiple decision trees and merges them together to get a more accurate and stable prediction.</li>
</ul>
</section>
<section id="probabilistic-forecasting-using-conformal-prediction" class="slide level2">
<h2>Probabilistic Forecasting using Conformal Prediction</h2>
<h3 id="conformal-prediction-for-time-series">Conformal Prediction for Time Series</h3>
<ul>
<li>A distribution-free method for constructing prediction intervals</li>
<li>A way to quantify the uncertainty of point forecasts by generating prediction intervals</li>
</ul>
<div class="fragment">
<h3 id="steps-to-generate-prediction-intervals">Steps to Generate Prediction Intervals</h3>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<ol type="1">
<li><strong>Point Forecasting</strong></li>
</ol>
<ul>
<li>Generate point forecasts <span class="math inline">\(\hat{y}_{t+h}\)</span> for the desired forecast horizon <span class="math inline">\(h\)</span> using rolling-origin cross-validation on a <code>calibration set</code> of 500 observations per horizon.</li>
</ul>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Residual Calculation</strong></li>
</ol>
<p><span class="math display">\[
r_{t+h} = y_{t+h} - \hat{y}_{t+h}
\]</span></p>
<p>where <span class="math inline">\(y_{t+h}\)</span> are the actual observed values and <span class="math inline">\(\hat{y}_{t+h}\)</span> are the point forecasts for <span class="math inline">\(t+h\)</span>.</p>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><strong>Nonconformity Scores</strong> <span class="math display">\[
A_{t+h} = |r_{t+h}|
\]</span></li>
</ol>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<ol start="4" type="1">
<li><strong>Quantile Calculation</strong></li>
</ol>
<p><span class="math display">\[
q_{1-\alpha}^{(h)} = \text{Quantile}_{1-\alpha}(\{A_{t-n+h}\}_{t=t-n}^{n})
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the size of the calibration set and <span class="math inline">\(1 - \alpha\)</span> is the desired coverage level</p>
</div>
<div class="fragment">
<ol start="5" type="1">
<li><strong>Prediction Intervals</strong></li>
</ol>
<p><span class="math display">\[
\left[\hat{y}_{t+h} - q_{1-\alpha}^{(h)}, \hat{y}_{t+h} + q_{1-\alpha}^{(h)}\right]
\]</span></p>
</div>
<div class="fragment">
<ol start="6" type="1">
<li><strong>Distribution Approximation</strong></li>
</ol>
<p><span class="math display">\[
y_{t+h}^{(i)} = \hat{y}_{t+h} + r_{t+h}^{(i)}, \quad r_{t+h}^{(i)} \in \{r_{t+h}^{(1)}, r_{t+h}^{(2)}, \ldots, r_{t+h}^{(n)}\}
\]</span></p>
</div>
</div></div>
</section>
<section id="forecasting-metrics" class="slide level2">
<h2>Forecasting metrics</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="point-forecasting-metrics">Point Forecasting Metrics</h3>
<ul>
<li><p>Root Mean Squared Error (RMSE) <span class="math display">\[
RMSE = \sqrt{\frac{1}{n} \sum_{t=1}^{n} (y_t - \hat{y}_t)^2}
\]</span></p></li>
<li><p>Mean Absolute Error (MAE) <span class="math display">\[
MAE = \frac{1}{n} \sum_{t=1}^{n} |y_t - \hat{y}_t|
\]</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="probabilistic-forecasting-metrics">Probabilistic Forecasting Metrics</h3>
<ul>
<li>Qunatile Loss (QL) <span class="math display">\[
QL_{\alpha} = 2 \sum_{t=1}^{h} \left[\alpha (y_t - \hat{y}_t^{(\alpha)}) \mathbb{1}_{\{y_t &gt; \hat{y}_t^{(\alpha)}\}} + (1 - \alpha) (\hat{y}_t^{(\alpha)} - y_t) \mathbb{1}_{\{y_t \leq \hat{y}_t^{(\alpha)}\}}\right]
\]</span></li>
</ul>
</div></div>
</section>
<section id="feature-engineering" class="slide level2">
<h2>Feature engineering</h2>
<ul>
<li>Time-based features</li>
</ul>
<p><br></p>
<ul>
<li>Public holidays</li>
</ul>
<p><br></p>
<ul>
<li>Lagged features</li>
</ul>
<p><br></p>
<ul>
<li>Fourier terms</li>
</ul>
<p><br></p>
<ul>
<li>Rolling window features</li>
</ul>
</section>
<section id="cross-validation-setup" class="slide level2">
<h2>Cross validation setup</h2>
<p>Rolling-origin cross-validation is used to evaluate model performance over time</p>
<div id="f2d69fa2" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="11">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-12-output-1.png" class="quarto-figure quarto-figure-center" width="1963" height="925"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="results" class="title-slide slide level1 center">
<h1>Results</h1>

</section>
<section id="point-forecast-results" class="slide level2">
<h2>Point Forecast results</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div id="5bf97d28" class="cell quarto-layout-cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="12" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_ec891 table {
  width: 100%;
  border-collapse: collapse;
}
#T_ec891 th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_ec891 td {
  font-size: 25px;
  text-align: left;
}
#T_ec891_row0_col0, #T_ec891_row0_col1, #T_ec891_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_ec891" class="caption-top">
<thead>
<tr class="header">
<th id="T_ec891_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_0</th>
<th id="T_ec891_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_ec891_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_ec891_row0_col0" class="data row0 col0" style="text-align: left;">HMM</td>
<td id="T_ec891_row0_col1" class="data row0 col1" style="text-align: left;">3.208</td>
<td id="T_ec891_row0_col2" class="data row0 col2" style="text-align: left;">2.757</td>
</tr>
<tr class="even">
<td id="T_ec891_row1_col0" class="data row1 col0" style="text-align: left;">linearRegression</td>
<td id="T_ec891_row1_col1" class="data row1 col1" style="text-align: left;">3.258</td>
<td id="T_ec891_row1_col2" class="data row1 col2" style="text-align: left;">2.804</td>
</tr>
<tr class="odd">
<td id="T_ec891_row2_col0" class="data row2 col0" style="text-align: left;">Lasso</td>
<td id="T_ec891_row2_col1" class="data row2 col1" style="text-align: left;">3.268</td>
<td id="T_ec891_row2_col2" class="data row2 col2" style="text-align: left;">2.832</td>
</tr>
<tr class="even">
<td id="T_ec891_row3_col0" class="data row3 col0" style="text-align: left;">RandomForest</td>
<td id="T_ec891_row3_col1" class="data row3 col1" style="text-align: left;">3.365</td>
<td id="T_ec891_row3_col2" class="data row3 col2" style="text-align: left;">2.885</td>
</tr>
<tr class="odd">
<td id="T_ec891_row4_col0" class="data row4 col0" style="text-align: left;">LightGBM</td>
<td id="T_ec891_row4_col1" class="data row4 col1" style="text-align: left;">3.364</td>
<td id="T_ec891_row4_col2" class="data row4 col2" style="text-align: left;">2.905</td>
</tr>
<tr class="even">
<td id="T_ec891_row5_col0" class="data row5 col0" style="text-align: left;">XGBoost</td>
<td id="T_ec891_row5_col1" class="data row5 col1" style="text-align: left;">3.433</td>
<td id="T_ec891_row5_col2" class="data row5 col2" style="text-align: left;">2.996</td>
</tr>
<tr class="odd">
<td id="T_ec891_row6_col0" class="data row6 col0" style="text-align: left;">ets</td>
<td id="T_ec891_row6_col1" class="data row6 col1" style="text-align: left;">3.679</td>
<td id="T_ec891_row6_col2" class="data row6 col2" style="text-align: left;">3.168</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="64800c8f" class="cell quarto-layout-cell" data-execution_count="13" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_8c8b3 table {
  width: 100%;
  border-collapse: collapse;
}
#T_8c8b3 th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_8c8b3 td {
  font-size: 25px;
  text-align: left;
}
#T_8c8b3_row0_col0, #T_8c8b3_row0_col1, #T_8c8b3_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_8c8b3" class="caption-top">
<thead>
<tr class="header">
<th id="T_8c8b3_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_1</th>
<th id="T_8c8b3_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_8c8b3_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_8c8b3_row0_col0" class="data row0 col0" style="text-align: left;">ets</td>
<td id="T_8c8b3_row0_col1" class="data row0 col1" style="text-align: left;">3.646</td>
<td id="T_8c8b3_row0_col2" class="data row0 col2" style="text-align: left;">3.169</td>
</tr>
<tr class="even">
<td id="T_8c8b3_row1_col0" class="data row1 col0" style="text-align: left;">Lasso</td>
<td id="T_8c8b3_row1_col1" class="data row1 col1" style="text-align: left;">3.701</td>
<td id="T_8c8b3_row1_col2" class="data row1 col2" style="text-align: left;">3.220</td>
</tr>
<tr class="odd">
<td id="T_8c8b3_row2_col0" class="data row2 col0" style="text-align: left;">RandomForest</td>
<td id="T_8c8b3_row2_col1" class="data row2 col1" style="text-align: left;">3.707</td>
<td id="T_8c8b3_row2_col2" class="data row2 col2" style="text-align: left;">3.229</td>
</tr>
<tr class="even">
<td id="T_8c8b3_row3_col0" class="data row3 col0" style="text-align: left;">linearRegression</td>
<td id="T_8c8b3_row3_col1" class="data row3 col1" style="text-align: left;">3.711</td>
<td id="T_8c8b3_row3_col2" class="data row3 col2" style="text-align: left;">3.233</td>
</tr>
<tr class="odd">
<td id="T_8c8b3_row4_col0" class="data row4 col0" style="text-align: left;">HMM</td>
<td id="T_8c8b3_row4_col1" class="data row4 col1" style="text-align: left;">3.712</td>
<td id="T_8c8b3_row4_col2" class="data row4 col2" style="text-align: left;">3.231</td>
</tr>
<tr class="even">
<td id="T_8c8b3_row5_col0" class="data row5 col0" style="text-align: left;">LightGBM</td>
<td id="T_8c8b3_row5_col1" class="data row5 col1" style="text-align: left;">3.720</td>
<td id="T_8c8b3_row5_col2" class="data row5 col2" style="text-align: left;">3.241</td>
</tr>
<tr class="odd">
<td id="T_8c8b3_row6_col0" class="data row6 col0" style="text-align: left;">XGBoost</td>
<td id="T_8c8b3_row6_col1" class="data row6 col1" style="text-align: left;">3.770</td>
<td id="T_8c8b3_row6_col2" class="data row6 col2" style="text-align: left;">3.277</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div id="73826997" class="cell quarto-layout-cell" data-execution_count="14" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_13e07 table {
  width: 100%;
  border-collapse: collapse;
}
#T_13e07 th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_13e07 td {
  font-size: 25px;
  text-align: left;
}
#T_13e07_row0_col0, #T_13e07_row0_col1, #T_13e07_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_13e07" class="caption-top">
<thead>
<tr class="header">
<th id="T_13e07_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_2</th>
<th id="T_13e07_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_13e07_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_13e07_row0_col0" class="data row0 col0" style="text-align: left;">HMM</td>
<td id="T_13e07_row0_col1" class="data row0 col1" style="text-align: left;">2.843</td>
<td id="T_13e07_row0_col2" class="data row0 col2" style="text-align: left;">2.406</td>
</tr>
<tr class="even">
<td id="T_13e07_row1_col0" class="data row1 col0" style="text-align: left;">linearRegression</td>
<td id="T_13e07_row1_col1" class="data row1 col1" style="text-align: left;">2.862</td>
<td id="T_13e07_row1_col2" class="data row1 col2" style="text-align: left;">2.426</td>
</tr>
<tr class="odd">
<td id="T_13e07_row2_col0" class="data row2 col0" style="text-align: left;">Lasso</td>
<td id="T_13e07_row2_col1" class="data row2 col1" style="text-align: left;">2.975</td>
<td id="T_13e07_row2_col2" class="data row2 col2" style="text-align: left;">2.538</td>
</tr>
<tr class="even">
<td id="T_13e07_row3_col0" class="data row3 col0" style="text-align: left;">LightGBM</td>
<td id="T_13e07_row3_col1" class="data row3 col1" style="text-align: left;">2.983</td>
<td id="T_13e07_row3_col2" class="data row3 col2" style="text-align: left;">2.544</td>
</tr>
<tr class="odd">
<td id="T_13e07_row4_col0" class="data row4 col0" style="text-align: left;">XGBoost</td>
<td id="T_13e07_row4_col1" class="data row4 col1" style="text-align: left;">3.036</td>
<td id="T_13e07_row4_col2" class="data row4 col2" style="text-align: left;">2.605</td>
</tr>
<tr class="even">
<td id="T_13e07_row5_col0" class="data row5 col0" style="text-align: left;">RandomForest</td>
<td id="T_13e07_row5_col1" class="data row5 col1" style="text-align: left;">3.141</td>
<td id="T_13e07_row5_col2" class="data row5 col2" style="text-align: left;">2.723</td>
</tr>
<tr class="odd">
<td id="T_13e07_row6_col0" class="data row6 col0" style="text-align: left;">ets</td>
<td id="T_13e07_row6_col1" class="data row6 col1" style="text-align: left;">3.210</td>
<td id="T_13e07_row6_col2" class="data row6 col2" style="text-align: left;">2.800</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="5de1f53b" class="cell quarto-layout-cell" data-execution_count="15" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_ae8bc table {
  width: 100%;
  border-collapse: collapse;
}
#T_ae8bc th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_ae8bc td {
  font-size: 25px;
  text-align: left;
}
#T_ae8bc_row0_col0, #T_ae8bc_row0_col1, #T_ae8bc_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_ae8bc" class="caption-top">
<thead>
<tr class="header">
<th id="T_ae8bc_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_3</th>
<th id="T_ae8bc_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_ae8bc_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_ae8bc_row0_col0" class="data row0 col0" style="text-align: left;">Lasso</td>
<td id="T_ae8bc_row0_col1" class="data row0 col1" style="text-align: left;">1.992</td>
<td id="T_ae8bc_row0_col2" class="data row0 col2" style="text-align: left;">1.664</td>
</tr>
<tr class="even">
<td id="T_ae8bc_row1_col0" class="data row1 col0" style="text-align: left;">LightGBM</td>
<td id="T_ae8bc_row1_col1" class="data row1 col1" style="text-align: left;">2.009</td>
<td id="T_ae8bc_row1_col2" class="data row1 col2" style="text-align: left;">1.700</td>
</tr>
<tr class="odd">
<td id="T_ae8bc_row2_col0" class="data row2 col0" style="text-align: left;">linearRegression</td>
<td id="T_ae8bc_row2_col1" class="data row2 col1" style="text-align: left;">2.044</td>
<td id="T_ae8bc_row2_col2" class="data row2 col2" style="text-align: left;">1.724</td>
</tr>
<tr class="even">
<td id="T_ae8bc_row3_col0" class="data row3 col0" style="text-align: left;">RandomForest</td>
<td id="T_ae8bc_row3_col1" class="data row3 col1" style="text-align: left;">2.058</td>
<td id="T_ae8bc_row3_col2" class="data row3 col2" style="text-align: left;">1.730</td>
</tr>
<tr class="odd">
<td id="T_ae8bc_row4_col0" class="data row4 col0" style="text-align: left;">HMM</td>
<td id="T_ae8bc_row4_col1" class="data row4 col1" style="text-align: left;">2.078</td>
<td id="T_ae8bc_row4_col2" class="data row4 col2" style="text-align: left;">1.749</td>
</tr>
<tr class="even">
<td id="T_ae8bc_row5_col0" class="data row5 col0" style="text-align: left;">XGBoost</td>
<td id="T_ae8bc_row5_col1" class="data row5 col1" style="text-align: left;">2.098</td>
<td id="T_ae8bc_row5_col2" class="data row5 col2" style="text-align: left;">1.776</td>
</tr>
<tr class="odd">
<td id="T_ae8bc_row6_col0" class="data row6 col0" style="text-align: left;">ets</td>
<td id="T_ae8bc_row6_col1" class="data row6 col1" style="text-align: left;">2.475</td>
<td id="T_ae8bc_row6_col2" class="data row6 col2" style="text-align: left;">2.133</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div id="e58ce624" class="cell quarto-layout-cell" data-execution_count="16" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_55104 table {
  width: 100%;
  border-collapse: collapse;
}
#T_55104 th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_55104 td {
  font-size: 25px;
  text-align: left;
}
#T_55104_row0_col0, #T_55104_row0_col1, #T_55104_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_55104" class="caption-top">
<thead>
<tr class="header">
<th id="T_55104_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_4</th>
<th id="T_55104_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_55104_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_55104_row0_col0" class="data row0 col0" style="text-align: left;">Lasso</td>
<td id="T_55104_row0_col1" class="data row0 col1" style="text-align: left;">2.320</td>
<td id="T_55104_row0_col2" class="data row0 col2" style="text-align: left;">1.999</td>
</tr>
<tr class="even">
<td id="T_55104_row1_col0" class="data row1 col0" style="text-align: left;">linearRegression</td>
<td id="T_55104_row1_col1" class="data row1 col1" style="text-align: left;">2.470</td>
<td id="T_55104_row1_col2" class="data row1 col2" style="text-align: left;">2.135</td>
</tr>
<tr class="odd">
<td id="T_55104_row2_col0" class="data row2 col0" style="text-align: left;">HMM</td>
<td id="T_55104_row2_col1" class="data row2 col1" style="text-align: left;">2.532</td>
<td id="T_55104_row2_col2" class="data row2 col2" style="text-align: left;">2.211</td>
</tr>
<tr class="even">
<td id="T_55104_row3_col0" class="data row3 col0" style="text-align: left;">ets</td>
<td id="T_55104_row3_col1" class="data row3 col1" style="text-align: left;">2.592</td>
<td id="T_55104_row3_col2" class="data row3 col2" style="text-align: left;">2.244</td>
</tr>
<tr class="odd">
<td id="T_55104_row4_col0" class="data row4 col0" style="text-align: left;">XGBoost</td>
<td id="T_55104_row4_col1" class="data row4 col1" style="text-align: left;">2.660</td>
<td id="T_55104_row4_col2" class="data row4 col2" style="text-align: left;">2.314</td>
</tr>
<tr class="even">
<td id="T_55104_row5_col0" class="data row5 col0" style="text-align: left;">RandomForest</td>
<td id="T_55104_row5_col1" class="data row5 col1" style="text-align: left;">2.825</td>
<td id="T_55104_row5_col2" class="data row5 col2" style="text-align: left;">2.486</td>
</tr>
<tr class="odd">
<td id="T_55104_row6_col0" class="data row6 col0" style="text-align: left;">LightGBM</td>
<td id="T_55104_row6_col1" class="data row6 col1" style="text-align: left;">3.344</td>
<td id="T_55104_row6_col2" class="data row6 col2" style="text-align: left;">2.946</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="6c66b9da" class="cell quarto-layout-cell" data-execution_count="17" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_a4585 table {
  width: 100%;
  border-collapse: collapse;
}
#T_a4585 th {
  background-color: #20808D;
  text-align: left;
  color: #FBFAF4;
  font-size: 30px;
  min-width: 80px;
}
#T_a4585 td {
  font-size: 25px;
  text-align: left;
}
#T_a4585_row0_col0, #T_a4585_row0_col1, #T_a4585_row0_col2 {
  font-weight: bold;
  background-color: None;
}
</style>

<table id="T_a4585" class="caption-top">
<thead>
<tr class="header">
<th id="T_a4585_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">ward_5</th>
<th id="T_a4585_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">RMSE</th>
<th id="T_a4585_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_a4585_row0_col0" class="data row0 col0" style="text-align: left;">HMM</td>
<td id="T_a4585_row0_col1" class="data row0 col1" style="text-align: left;">2.500</td>
<td id="T_a4585_row0_col2" class="data row0 col2" style="text-align: left;">2.122</td>
</tr>
<tr class="even">
<td id="T_a4585_row1_col0" class="data row1 col0" style="text-align: left;">RandomForest</td>
<td id="T_a4585_row1_col1" class="data row1 col1" style="text-align: left;">2.503</td>
<td id="T_a4585_row1_col2" class="data row1 col2" style="text-align: left;">2.129</td>
</tr>
<tr class="odd">
<td id="T_a4585_row2_col0" class="data row2 col0" style="text-align: left;">LightGBM</td>
<td id="T_a4585_row2_col1" class="data row2 col1" style="text-align: left;">2.511</td>
<td id="T_a4585_row2_col2" class="data row2 col2" style="text-align: left;">2.143</td>
</tr>
<tr class="even">
<td id="T_a4585_row3_col0" class="data row3 col0" style="text-align: left;">XGBoost</td>
<td id="T_a4585_row3_col1" class="data row3 col1" style="text-align: left;">2.512</td>
<td id="T_a4585_row3_col2" class="data row3 col2" style="text-align: left;">2.144</td>
</tr>
<tr class="odd">
<td id="T_a4585_row4_col0" class="data row4 col0" style="text-align: left;">Lasso</td>
<td id="T_a4585_row4_col1" class="data row4 col1" style="text-align: left;">2.517</td>
<td id="T_a4585_row4_col2" class="data row4 col2" style="text-align: left;">2.144</td>
</tr>
<tr class="even">
<td id="T_a4585_row5_col0" class="data row5 col0" style="text-align: left;">linearRegression</td>
<td id="T_a4585_row5_col1" class="data row5 col1" style="text-align: left;">2.532</td>
<td id="T_a4585_row5_col2" class="data row5 col2" style="text-align: left;">2.156</td>
</tr>
<tr class="odd">
<td id="T_a4585_row6_col0" class="data row6 col0" style="text-align: left;">ets</td>
<td id="T_a4585_row6_col1" class="data row6 col1" style="text-align: left;">2.603</td>
<td id="T_a4585_row6_col2" class="data row6 col2" style="text-align: left;">2.235</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="forecast-distributions-quantile-scores" class="slide level2">
<h2>Forecast Distributions (Quantile scores)</h2>
<div id="45c5b850" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="18">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-19-output-1.png" class="quarto-figure quarto-figure-center" width="1882" height="955"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="forecast-distributions-quantile-scores-1" class="slide level2">
<h2>Forecast Distributions (Quantile scores)</h2>
<div id="4491ed5b" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="19">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-20-output-1.png" class="quarto-figure quarto-figure-center" width="1882" height="955"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="forecast-distributions-quantile-scores-for-45-to-85" class="slide level2">
<h2>Forecast distributions (Quantile scores for 45% to 85%)</h2>
<div id="91f39aa3" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="20">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-21-output-1.png" class="quarto-figure quarto-figure-center" width="1733" height="955"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="models-explainability" class="slide level2">
<h2>Model’s Explainability</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div id="b32dc6de" class="cell" data-fig-height="100%" data-fig-width="100%" data-execution_count="21">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="slides_files/figure-revealjs/cell-22-output-1.png" class="quarto-figure quarto-figure-center" width="1813" height="919"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<h3 id="transition-probabilities">Transition probabilities</h3>
<div id="fdf0cbe6" class="cell" data-execution_count="22">
<div class="cell-output cell-output-display cell-output-markdown">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">T. Matrix</th>
<th style="text-align: right;">Regime 1</th>
<th style="text-align: right;">Regime 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Regime 1</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.334</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regime 2</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">0.513</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br> <br></p>
<h3 id="standard-deviations">Standard Deviations</h3>
<div id="7ec096f0" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display cell-output-markdown">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Std. Dev.</th>
<th style="text-align: right;">Regime 1</th>
<th style="text-align: right;">Regime 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">1.393</td>
<td style="text-align: right;">0.006</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="key-findings" class="title-slide slide level1 center">
<h1>Key findings</h1>

</section>
<section id="learning-outcomes-from-the-current-experiments" class="slide level2">
<h2>Learning outcomes from the current experiments</h2>
<ul>
<li><p>Although AR-RHMM may not always outperform all benchmark models in point forecasting metrics, there is a significant improvement in probabilistic forecasting, particularly in quantile loss across 40% and 85% quantiles.</p></li>
<li><p>The model is more reliable for probabilistic forecasting since it accounts for regime changes and provides a distribution of possible future values, making it suitable for decision-making in hospital resource management.</p></li>
<li><p>The model performs consistently well interms of <code>probabilistic forecasting</code> since the model is probabilistic in nature and captures regime changes.</p></li>
</ul>
</section></section>
<section>
<section id="next-steps" class="title-slide slide level1 center">
<h1>Next steps</h1>

</section>
<section id="next-steps-1" class="slide level2">
<h2>Next steps</h2>
<ul>
<li><p>Extend the AR-HMM to a multivariate framework (VAR-HMM) to jointly model multiple wards, capturing interdependencies and shared patterns in bed occupancy across different wards.</p></li>
<li><p>Develop an optimization framework that utilizes the probabilistic forecasts from the AR-HMM and VAR-HMM models to optimize bed allocation and resource management.</p></li>
<li><p>Test the models in real-world scenarios, collaborating with hospital staff to refine the models based on practical feedback and operational needs.</p></li>
</ul>
</section></section>
<section id="any-questions-or-thoughts" class="title-slide slide level1 center">
<h1>Any questions or thoughts? 💬</h1>



<img data-src="images/follow_us.png" class="quarto-figure quarto-figure-center r-stretch"></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://mustafaslancoto.github.io/talks/presentations/wgsss.html">Forecasting Mental Health Hospital Bed Occupancy: A Regime-Switching AutoRegressive Hidden Markov Model Approach</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 2100,

        height: 1200,

        // Factor of the display size that should remain empty around the content
        margin: 6.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/mustafaslanCoto\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>